[gd_scene load_steps=20 format=3 uid="uid://dt5anurf2hd6c"]

[ext_resource type="Script" uid="uid://cvqf1hrebc04p" path="res://scripts/bot.gd" id="1_fulsm"]
[ext_resource type="Script" uid="uid://ce0lih35lp5ov" path="res://scripts/bits/movemaster2d.gd" id="2_4r5pv"]
[ext_resource type="Script" uid="uid://cjub2h8aynu37" path="res://scripts/bits/movebits/control_bits/vehicle_control.gd" id="3_60mlk"]
[ext_resource type="Texture2D" uid="uid://bks847nvlppd4" path="res://assets/textures/cart.png" id="4_4r5pv"]
[ext_resource type="Script" uid="uid://c7kkv1iuav8gk" path="res://scripts/bits/value.gd" id="4_i4ail"]
[ext_resource type="Script" uid="uid://bc87fqj83okns" path="res://scripts/bits/property_modifier.gd" id="5_a38lo"]
[ext_resource type="Script" uid="uid://b1o48vkwquyxs" path="res://scripts/values/node/manual_node.gd" id="6_4ni07"]
[ext_resource type="Script" uid="uid://bxl20cm7r57lo" path="res://scripts/values/string/concat_string.gd" id="7_l71n6"]
[ext_resource type="Script" uid="uid://64djo1ycff7k" path="res://scripts/values/bit.gd" id="8_ke2ow"]
[ext_resource type="Script" uid="uid://hg8o6oww1p4g" path="res://scripts/bits/value_modifier.gd" id="9_ujl30"]
[ext_resource type="Script" uid="uid://b3pqxy3hkl2fo" path="res://scripts/values/float/constrained_float.gd" id="10_31cv2"]
[ext_resource type="Script" uid="uid://cae7ohv2js782" path="res://scripts/values/float/modified_float.gd" id="11_pf23h"]
[ext_resource type="Script" uid="uid://bdjqjjp8vifaj" path="res://scripts/values/float/cast_float.gd" id="12_dt7fs"]
[ext_resource type="Script" path="res://scripts/values/property.gd" id="13_wqfne"]
[ext_resource type="Script" uid="uid://dc8sod06feafh" path="res://scripts/values/float/manual_float.gd" id="14_wnwbv"]
[ext_resource type="Script" uid="uid://dw7w6pry2g435" path="res://scripts/bits/player_animator.gd" id="15_gl8cc"]
[ext_resource type="Script" uid="uid://b4bckvlqxiuxn" path="res://scripts/bits/condition.gd" id="16_487ah"]
[ext_resource type="Script" uid="uid://cbcstrsy2txwl" path="res://scripts/values/bool/inequality.gd" id="17_md1ol"]
[ext_resource type="Script" uid="uid://bslmamakq2ao5" path="res://scripts/values/node/group_node.gd" id="18_bj30b"]

[node name="Player" type="Node2D" groups=["Player"]]
script = ExtResource("1_fulsm")

[node name="MoveMaster" type="CharacterBody2D" parent="."]
collision_mask = 4
motion_mode = 1
script = ExtResource("2_4r5pv")

[node name="VehicleControlBit" type="Node" parent="MoveMaster"]
script = ExtResource("3_60mlk")
rotation_max_speed = 160.0
rotation_acceleration = 300.0
move_max_speed = 720.0
move_acceleration = 350.0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="MoveMaster"]
polygon = PackedVector2Array(-27, -48, 24, -48, 36, 27, -33, 28)

[node name="Sprite2D" type="Sprite2D" parent="."]
texture_filter = 1
texture = ExtResource("4_4r5pv")

[node name="Stamina" type="Node" parent="."]
script = ExtResource("4_i4ail")
id = "Stamina"
value = 300.0

[node name="ValueModifierBit" type="Node" parent="." node_paths=PackedStringArray("target", "new_value")]
script = ExtResource("9_ujl30")
target = NodePath("LockFloat/StaminaMinused/StaminaValue/Value/Stamina")
value_id = "Stamina"
new_value = NodePath("LockFloat")
constant = true
metadata/_custom_type_script = "uid://hg8o6oww1p4g"

[node name="LockFloat" type="Node" parent="ValueModifierBit" node_paths=PackedStringArray("input", "minimum")]
script = ExtResource("10_31cv2")
input = NodePath("StaminaMinused")
minimum = NodePath("0")

[node name="StaminaMinused" type="Node" parent="ValueModifierBit/LockFloat"]
script = ExtResource("11_pf23h")
operation = 1
metadata/_custom_type_script = "uid://cae7ohv2js782"

[node name="StaminaValue" type="Node" parent="ValueModifierBit/LockFloat/StaminaMinused"]
script = ExtResource("12_dt7fs")
metadata/_custom_type_script = "uid://bdjqjjp8vifaj"

[node name="Value" type="Node" parent="ValueModifierBit/LockFloat/StaminaMinused/StaminaValue"]
script = ExtResource("13_wqfne")
property = "value"

[node name="Stamina" type="Node" parent="ValueModifierBit/LockFloat/StaminaMinused/StaminaValue/Value" node_paths=PackedStringArray("response")]
script = ExtResource("6_4ni07")
response = NodePath("../../../../../../Stamina")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[node name="1" type="Node" parent="ValueModifierBit/LockFloat/StaminaMinused"]
script = ExtResource("14_wnwbv")
response = 0.1
metadata/_custom_type_script = "uid://dc8sod06feafh"

[node name="0" type="Node" parent="ValueModifierBit/LockFloat"]
script = ExtResource("14_wnwbv")
metadata/_custom_type_script = "uid://dc8sod06feafh"

[node name="PlayerAnimatorBit" type="Node" parent="." node_paths=PackedStringArray("player")]
script = ExtResource("15_gl8cc")
animation = "lost"
player = NodePath("GetAnimator")
metadata/_custom_type_script = "uid://dw7w6pry2g435"

[node name="OnStaminaZero" type="Node" parent="PlayerAnimatorBit"]
script = ExtResource("16_487ah")
single = true

[node name="StaminaZero" type="Node" parent="PlayerAnimatorBit/OnStaminaZero" node_paths=PackedStringArray("value_a", "value_b")]
script = ExtResource("17_md1ol")
value_a = NodePath("../../../ValueModifierBit/LockFloat")
value_b = NodePath("../../../ValueModifierBit/LockFloat/0")
metadata/_custom_type_script = "uid://cbcstrsy2txwl"

[node name="GetAnimator" type="Node" parent="PlayerAnimatorBit"]
script = ExtResource("18_bj30b")
group_name = "Animator"
metadata/_custom_type_script = "uid://bslmamakq2ao5"

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Label" type="ProgressBar" parent="CanvasLayer"]
offset_left = 19.0
offset_top = 19.0
offset_right = 467.0
offset_bottom = 102.0
max_value = 300.0

[node name="DisplayStamina" type="Node" parent="CanvasLayer/Label"]
script = ExtResource("5_a38lo")
property = "value"
constant = true

[node name="ManualNode" type="Node" parent="CanvasLayer/Label/DisplayStamina" node_paths=PackedStringArray("response")]
script = ExtResource("6_4ni07")
response = NodePath("../..")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[node name="ConcatString" type="Node" parent="CanvasLayer/Label/DisplayStamina"]
script = ExtResource("7_l71n6")
metadata/_custom_type_script = "uid://bxl20cm7r57lo"

[node name="BitValue" type="Node" parent="CanvasLayer/Label/DisplayStamina/ConcatString"]
script = ExtResource("8_ke2ow")
id = "Stamina"
metadata/_custom_type_script = "uid://64djo1ycff7k"

[node name="ManualNode" type="Node" parent="CanvasLayer/Label/DisplayStamina/ConcatString/BitValue" node_paths=PackedStringArray("response")]
script = ExtResource("6_4ni07")
response = NodePath("../../../../../..")
metadata/_custom_type_script = "uid://b1o48vkwquyxs"

[connection signal="condition_true" from="PlayerAnimatorBit/OnStaminaZero" to="PlayerAnimatorBit" method="animate"]
